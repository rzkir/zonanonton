---
export interface Props {
  title: string;
  image: string;
  year?: string;
  rating?: string;
  type?: "anime" | "drama" | "film";
  featured?: boolean;
  href?: string;
  className?: string;
}

const {
  title,
  image,
  year = "",
  rating = "",
  type = "film",
  featured = false,
  href = "#",
  className = "",
} = Astro.props;

const typeColors: Record<string, string> = {
  anime: "from-rose-500/20 to-pink-600/20 border-rose-500/30",
  drama: "from-amber-500/20 to-orange-600/20 border-amber-500/30",
  film: "from-violet-500/20 to-purple-600/20 border-violet-500/30",
};
const typeLabel: Record<string, string> = {
  anime: "Anime",
  drama: "Drama",
  film: "Film",
};
---

<div
  class:list={[
    "media-card block rounded-xl overflow-hidden bg-[#1a1a24] border border-white/6 p-0 gap-0 shadow-none group min-w-[140px] sm:min-w-[180px] cursor-pointer",
    featured && "aspect-2/3 sm:aspect-video",
    className,
  ]}
>
  <a href={href} class="block">
    <div class="relative aspect-2/3 sm:aspect-video overflow-hidden">
      <img
        src={image}
        alt={title}
        class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
        loading="lazy"
      />
      <div
        class="absolute inset-0 bg-linear-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"
      >
      </div>
      <div
        class="absolute bottom-0 left-0 right-0 p-3 translate-y-full group-hover:translate-y-0 transition-transform duration-300"
      >
        <span
          class:list={[
            "inline-block px-2 py-0.5 rounded text-xs font-medium bg-linear-to-r border text-white",
            typeColors[type],
          ]}
        >
          {typeLabel[type]}
        </span>
        {
          (year || rating) && (
            <p class="text-xs text-zinc-300 mt-1">
              {year}
              {year && rating ? " · " : ""}
              {rating && `${rating} ★`}
            </p>
          )
        }
      </div>
      <div
        class="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity"
      >
        <span
          class="flex items-center justify-center w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm border border-white/30"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="currentColor"
            class="text-white ml-0.5"
          >
            <polygon points="5 3 19 12 5 21 5 3"></polygon>
          </svg>
        </span>
      </div>
    </div>
    {
      !featured && (
        <div class="p-2.5 sm:p-3 px-3">
          <div class="font-semibold text-sm sm:text-base text-white line-clamp-2 group-hover:text-rose-400 transition-colors">
            {title}
          </div>
        </div>
      )
    }
  </a>
</div>
