---
// Bottom nav untuk filter konten homepage (Semua, Anime, Manga, Film, Drakor).
// Panel (.home-tab-panel) harus ada di halaman yang sama.
---

<!-- Bottom nav: pill bar, icon-only, transform pindah ke tab yang aktif -->
<nav
  role="tablist"
  aria-label="Filter konten homepage"
  class="home-bottom-nav fixed bottom-4 left-0 right-0 z-40 px-4 pb-[env(safe-area-inset-bottom)]"
>
  <div class="home-bottom-nav-bar w-full max-w-[320px] mx-auto flex items-end justify-around rounded-full bg-white/95 dark:bg-gray-800/95 backdrop-blur-md shadow-lg border border-gray-200/50 dark:border-white/10 py-2 px-3 min-h-[56px]">
    <button
      type="button"
      role="tab"
      aria-selected="true"
      aria-label="Semua"
      id="tab-semua"
      data-tab-filter="semua"
      class="home-tab home-tab-active flex items-center justify-center flex-1 min-w-0 h-11 rounded-full text-gray-500 transition-all duration-300"
    >
      <svg class="w-6 h-6 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
      </svg>
    </button>
    <button
      type="button"
      role="tab"
      aria-selected="false"
      aria-label="Anime"
      id="tab-anime"
      data-tab-filter="anime"
      class="home-tab flex items-center justify-center flex-1 min-w-0 h-11 rounded-full text-gray-500 transition-all duration-300"
    >
      <svg class="w-6 h-6 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
    </button>
    <button
      type="button"
      role="tab"
      aria-selected="false"
      aria-label="Manga"
      id="tab-manga"
      data-tab-filter="manga"
      class="home-tab flex items-center justify-center flex-1 min-w-0 h-11 rounded-full text-gray-500 transition-all duration-300"
    >
      <svg class="w-6 h-6 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
      </svg>
    </button>
    <button
      type="button"
      role="tab"
      aria-selected="false"
      aria-label="Film"
      id="tab-film"
      data-tab-filter="film"
      class="home-tab flex items-center justify-center flex-1 min-w-0 h-11 rounded-full text-gray-500 transition-all duration-300"
    >
      <svg class="w-6 h-6 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" />
      </svg>
    </button>
    <button
      type="button"
      role="tab"
      aria-selected="false"
      aria-label="Drakor"
      id="tab-drakor"
      data-tab-filter="drakor"
      class="home-tab flex items-center justify-center flex-1 min-w-0 h-11 rounded-full text-gray-500 transition-all duration-300"
    >
      <svg class="w-6 h-6 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
      </svg>
    </button>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const tabs = document.querySelectorAll('.home-tab');
    const panels = document.querySelectorAll('.home-tab-panel');

    function setActiveTab(selectedFilter: string) {
      tabs.forEach((tab) => {
        const filter = tab.getAttribute('data-tab-filter');
        const isSelected = filter === selectedFilter;
        tab.setAttribute('aria-selected', String(isSelected));
        tab.classList.remove('home-tab-active');
        if (isSelected) tab.classList.add('home-tab-active');
      });

      panels.forEach((panel) => {
        const el = panel as HTMLElement;
        const tab = el.getAttribute('data-tab');
        const show = selectedFilter === 'semua' || tab === selectedFilter;
        el.style.display = show ? '' : 'none';
      });

      // Sinkronkan hero carousel: tampilkan hero sesuai tab (semua = anime)
      const heroPanels = document.querySelectorAll<HTMLElement>('[data-hero-panel]');
      const heroTab = selectedFilter === 'semua' ? 'anime' : selectedFilter;
      heroPanels.forEach((el) => {
        const tab = el.getAttribute('data-tab');
        const show = tab === heroTab;
        el.classList.toggle('hidden', !show);
      });
    }

    function scrollToCarousel() {
      const el = document.getElementById('home-hero-carousel');
      if (el) {
        el.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    tabs.forEach((tab) => {
      tab.addEventListener('click', () => {
        const filter = tab.getAttribute('data-tab-filter');
        if (filter) {
          setActiveTab(filter);
          scrollToCarousel();
        }
      });
    });

    setActiveTab('semua');
  });
</script>

<style>
  /* Semua tab: inactive = icon biasa */
  .home-tab:not(.home-tab-active) {
    color: rgb(156 163 175);
    background-color: transparent;
  }
  .home-tab:not(.home-tab-active):hover {
    color: rgb(75 85 99);
  }
  /* Tab yang aktif = lingkaran terangkat (FAB), pindah ikut yang diklik */
  .home-tab.home-tab-active,
  .home-tab[aria-selected="true"] {
    width: 3.5rem;
    height: 3.5rem;
    min-width: 3.5rem;
    margin-top: -1.5rem;
    color: white;
    background-color: rgb(75 85 99);
    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.25);
  }
  .home-tab.home-tab-active svg,
  .home-tab[aria-selected="true"] svg {
    width: 1.5rem;
    height: 1.5rem;
  }
</style>
